doctype html
include ../../../SharedComponents/Layouts/header.jade
html
  head
    meta(charset='utf-8')
    |   
    meta(http-equiv='X-UA-Compatible', content='IE=edge')
    |   
    title #{user.gubaye.name} 
    // Tell the browser to be responsive to screen width
    meta(name='viewport', content='width=device-width, initial-scale=1')
    // Font Awesome
    link(rel='stylesheet', href='../../ADMINLITE/plugins/fontawesome-free/css/all.min.css')
    // Ionicons
    link(rel='stylesheet', href='https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css')
    // Theme style
    link(rel='stylesheet', href='static/dist/css/adminlte.min.css')
    // Google Font: Source Sans Pro
    link(href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700', rel='stylesheet')
    script(src='../../ADMINLITE/plugins/jquery/jquery.min.js')

  body.hold-transition.sidebar-mini
    .wrapper
      // Navbar
      include ../../../SharedComponents/Layouts/navigation.jade
      // Main Sidebar Container
      include ../../../SharedComponents/Layouts/sidebarNU.jade
      script(src="/STB/Workspaces/SierateTimhert/js/GubayeTSDA.js") 

      // Content Wrapper. Contains page content
      .content-wrapper
        // Content Header (Page header)
        section.content-header
          .container-fluid
            .row.mb-2
              .col-sm-12
                h1 ጉባኤያት
              |           
              .col-sm-12
                ol.breadcrumb.float-sm-right
                  li.breadcrumb-item
                    a(href='/STB/SirateTimhert/SubDepartmentAdmin') ስዕራተ ትምህርት ንኡስ ክፍል
                  li.breadcrumb-item.active ጉባኤ #{user.gubaye.name}
            .row
              .col-md-3
                .card.card-primary.card-outline
                  .card-body.box-profile
                    .text-center
                      img.profile-user-img.img-fluid.img-circle(src='#{user.gubaye.profilePic}', alt='User profile picture')
                    |                 
                    h3.profile-username.text-center ጉባኤ #{user.gubaye.name}
                    |                 
                    p.text-muted.text-center
                    |     
                    //used to delete group
                    button(type='button', class="btn btn-block btn-primary", data-toggle='modal', data-target='#modal_pic-sm') ምስል በትልቁ እይ
                    ul.list-group.list-group-unbordered.mb-3
                      li.list-group-item
                        b አስተባባሪ
                        p #{user.gubaye.leader}
                      li.list-group-item
                        b ዝርዝር
                        p #{user.gubaye.description}
              .col-md-9
                .card
                  .card-header.p-2
                    ul.nav.nav-pills
                      li.nav-item
                        a.nav-link.active(href='#member', data-toggle='tab') አባላት
                      |                   
                      li.nav-item
                        a.nav-link(href='#education', data-toggle='tab') ትምህርት
                      |                   
                      li.nav-item
                        a.nav-link(href='#management', data-toggle='tab') አስተካክል
                  // /.card-header
                  .card-body
                    .tab-content
                      #member.active.tab-pane
                        .row
                          if(user.gubayemembers)
                            each val in user.gubayemembers
                              .col-12.col-sm-6.col-md-4
                                .info-box.mb-3
                                  span.info-box-icon.bg-success.elevation-1
                                    img(height = 100 style="width:100%" src="#{val.pro_img}" alt="User profile image")
                                  .info-box-content
                                    a.users-list-name(href="/STB/accounts/public/profile/#{val.telephone}") #{val.name}
                                    a(href="/STB/SirateTimhert/Gubaye_Nius_Sebsabi/#{user.gubaye._id}/Remove/#{val.telephone}")
                                      button(type='button', class="btn btn-block btn-danger btn-xs") አስወጣ
                          .col-12.col-sm-6.col-md-3
                            button(type='button', class="btn btn-block btn-primary btn-lg", data-toggle='modal', data-target='#modal-sm')
                              div(class="fas fa-plus nav-plus")
                            a(href="#" class="users-list-name") አባል ጨምር
                        script(src='../../ADMINLITE/plugins/bootstrap/js/bootstrap.bundle.min.js')
                        script(src='../../ADMINLITE/plugins/sweetalert2/sweetalert2.min.js')
                        script(src='../../ADMINLITE/plugins/toastr/toastr.min.js')
                        script(src='../../ADMINLITE/dist/js/adminlte.min.js')
                        script(src='../../ADMINLITE/dist/js/demo.js')

                      #modal-sm.modal.fade(style='display: none;', aria-hidden='true')
                        .modal-dialog.modal-course
                          .modal-content
                            .modal-header
                              h4.modal-title ጉባኤ #{user.gubaye.name} : አዲስ አባል ይጨምሩ
                              button.close(type='button', data-dismiss='modal', aria-label='Close')
                                span(aria-hidden='true') ×
                            .modal-body
                              link(rel='stylesheet', href='../../ADMINLITE/plugins/fontawesome-free/css/all.min.css')
                              link(rel='stylesheet', href='https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css')
                              link(rel='stylesheet', href='../../ADMINLITE/plugins/daterangepicker/daterangepicker.css')
                              link(rel='stylesheet', href='../../ADMINLITE/plugins/icheck-bootstrap/icheck-bootstrap.min.css')
                              link(rel='stylesheet', href='../../ADMINLITE/plugins/bootstrap-colorpicker/css/bootstrap-colorpicker.min.css')
                              link(rel='stylesheet', href='../../ADMINLITE/plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css')
                              link(rel='stylesheet', href='../../ADMINLITE/plugins/select2/css/select2.min.css')
                              link(rel='stylesheet', href='../../ADMINLITE/plugins/select2-bootstrap4-theme/select2-bootstrap4.min.css')
                              link(rel='stylesheet', href='../../ADMINLITE/plugins/bootstrap4-duallistbox/bootstrap-duallistbox.min.css')
                              link(rel='stylesheet', href='../../ADMINLITE/dist/css/adminlte.min.css')
                              link(href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700', rel='stylesheet')
                              script(src='../../ADMINLITE/plugins/bootstrap/js/bootstrap.bundle.min.js')
                              script(src='../../ADMINLITE/plugins/select2/js/select2.full.min.js')
                              script(src='../../ADMINLITE/plugins/bootstrap4-duallistbox/jquery.bootstrap-duallistbox.min.js')
                              script(src='../../ADMINLITE/plugins/moment/moment.min.js')
                              script(src='../../ADMINLITE/plugins/inputmask/min/jquery.inputmask.bundle.min.js')
                              script(src='../../ADMINLITE/plugins/daterangepicker/daterangepicker.js')
                              script(src='../../ADMINLITE/plugins/bootstrap-colorpicker/js/bootstrap-colorpicker.min.js')
                              script(src='../../ADMINLITE/plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js')
                              script(src='../../ADMINLITE/plugins/bootstrap-switch/js/bootstrap-switch.min.js')
                              script(src='../../ADMINLITE/dist/js/adminlte.min.js')
                              script(src='../../ADMINLITE/dist/js/demo.js')
                              script.
                                $(function () {
                                //Initialize Select2 Elements
                                $('.select2').select2()
                                //Initialize Select2 Elements
                                $('.select2bs4').select2({
                                theme: 'bootstrap4'
                                })
                                $('.select4').select2()
                                //Initialize Select2 Elements
                                $('.select4bs4').select2({
                                theme: 'bootstrap4'
                                })
                                //Datemask dd/mm/yyyy
                                $('#datemask').inputmask('dd/mm/yyyy', { 'placeholder': 'dd/mm/yyyy' })
                                //Datemask2 mm/dd/yyyy
                                $('#datemask2').inputmask('mm/dd/yyyy', { 'placeholder': 'mm/dd/yyyy' })
                                //Money Euro
                                $('[data-mask]').inputmask()
                                //Date range picker
                                $('#reservation').daterangepicker()
                                //Date range picker with time picker
                                $('#reservationtime').daterangepicker({
                                timePicker: true,
                                timePickerIncrement: 30,
                                locale: {
                                format: 'MM/DD/YYYY hh:mm A'
                                }
                                })
                                //Date range as a button
                                $('#daterange-btn').daterangepicker(
                                {
                                ranges   : {
                                'Today'       : [moment(), moment()],
                                'Yesterday'   : [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                                'Last 7 Days' : [moment().subtract(6, 'days'), moment()],
                                'Last 30 Days': [moment().subtract(29, 'days'), moment()],
                                'This Month'  : [moment().startOf('month'), moment().endOf('month')],
                                'Last Month'  : [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
                                },
                                startDate: moment().subtract(29, 'days'),
                                endDate  : moment()
                                },
                                function (start, end) {
                                $('#reportrange span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'))
                                }
                                )
                                //Timepicker
                                $('#timepicker').datetimepicker({
                                format: 'LT'
                                })
                                //Bootstrap Duallistbox
                                $('.duallistbox').bootstrapDualListbox()
                                //Colorpicker
                                $('.my-colorpicker1').colorpicker()
                                //color picker with addon
                                $('.my-colorpicker2').colorpicker()
                                $('.my-colorpicker2').on('colorpickerChange', function(event) {
                                $('.my-colorpicker2 .fa-square').css('color', event.color.toString());
                                });
                                $("input[data-bootstrap-switch]").each(function(){
                                $(this).bootstrapSwitch('state', $(this).prop('checked'));
                                });
                                })

                              .form-group(data-select2-id='40')
                                label ወደ ጉባኤው ለማስገባት የሚፈልጉትን ስርዓተ ትምህርት ይምረጡና ሲጨርሱ ጨምር የሚለውን በተን ይጫኑ 
                                select.select4.select2-hidden-accessible(multiple='',data-placeholder='አባል ይምረጡ', style='width: 100%;', data-select2-id='8', tabindex='-1', aria-hidden='true')
                                  each uuser in user.allusers
                                    option(data-select2-id='#{uuser._id}' value='#{uuser._id}') #{uuser.name}                            
                            .modal-footer.justify-content-between
                              button.btn.btn-default(type='button', data-dismiss='modal') ዝጋ
                              button.btn.btn-primary(type='button' onclick="addmembers('#{user.gubaye._id}');") ጨምር
                          // /.modal-dialog
                      #education.tab-pane
                        if(user.gubaye.curriculum != "60701692b1a1c822e0f45291")
                          each curriculum in curriculums
                            if(curriculum._id ==user.gubaye.curriculum)
                              h3 
                                a(href="/STB/SirateTimhert/SubDepartmentAdmin/curriculum/#{curriculum._id}") #{curriculum.name}
                              .row
                                .col-5.col-sm-3
                                  #vert-tabs-tab.nav.flex-column.nav-tabs.h-100(role='tablist' aria-orientation='vertical')
                                  if(curriculum.grades.length>0)                                    
                                    each grade in curriculum.grades
                                      a.nav-link(id = "G#{grade._id}-tab" data-toggle='pill' href='#G#{grade._id}' role='tab' aria-controls='G#{grade._id}' aria-selected='false') #{grade.name}
                                .col-7.col-sm-9
                                  #vert-tabs-tabContent.tab-content
                                  if(curriculum.grades.length>0)  
                                    each grade in curriculum.grades
                                      div(id="G#{grade._id}" class="tab-pane fade" role='tabpanel' aria-labelledby='G#{grade._id}-tab')
                                        h1 #{grade.name}                                  
                                        h6 የተመደቡ ኮርሶች
                                        .row
                                          each course in grade.courses 
                                            .col-12.col-sm-6.col-md-4
                                              .info-box.mb-3
                                                span.info-box-icon.bg-success.elevation-1
                                                  i.fas.fa-book
                                                .info-box-content
                                                
                                                  a(href='/STB/SirateTimhert/course/Gubaye_Nius_Sebsabi/#{course.course_id}/#{user.gubaye._id}') #{course.course_name}
                                                  if(course.activated)
                                                    p Non Active
                                                  if(!course.activated)
                                                    p Active
                                        br
                                        h6 የክፍሉ አላማ
                                        p #{grade.description}
                        else
                          .col-12.col-sm-6.col-md-3
                            button(type='button', class="btn btn-block btn-primary btn-lg", data-toggle='modal', data-target='#modal_curr-sm')
                              .fas.fa-plus.nav-plus
                            a(href="#" class="users-list-name") ስርዓተ ትምህርት መድብ
                     
                      #management.tab-pane
                        .row
                          .col-md-12
                            .card
                              .card-header.p-2
                                ul.nav.nav-pills                 
                                  li.nav-item
                                    a.nav-link.active(href='#settings', data-toggle='tab') አስተካክል
                              .card-body
                                .tab-content
                                  #settings.active.tab-pane
                                    form(method="post", action="../STB/Gubaye/Update").form-horizontal
                                      .form-group.row
                                        label.col-sm-2.col-form-label(for='inputName') የጉባኤው ስም
                                        |                         
                                        .col-sm-10
                                          input.form-control(type='text', placeholder='የጉባኤው ስም', value="#{user.gubaye.name}", id="name", name='name')
                                        |                       
                                      .form-group.row
                                        label.col-sm-2.col-form-label(for='inputEmail') ዝርዝር
                                        |                         
                                        .col-sm-10
                                          input.form-control(type='text', placeholder='ዝርዝር', value="#{user.gubaye.description}", id="description", name='description')
                                      |                      
                                      .form-group.row
                                        label.col-sm-2.col-form-label(for='inputTel') ጉባኤ አስተዳዳሪ
                                        |                         
                                        .col-sm-10
                                          select.input.form-control(style='width: 100%;' id="admin", name='admin' data-placeholder="አስተባባሪ")
                                              option(selected) #{user.gubaye.leader}
                                              each uuser in user.allusers
                                                if user.gubaye.leader != uuser.name
                                                  option #{uuser.name}
                                          //-input.form-control(type='text', placeholder='ጉብኤ አስተዳዳሪ', value="#{user.gubaye.leader}", id="admin", name='admin') 
                                          input(type='hidden', placeholder='የጋባኤው ስም', value="#{user.gubaye._id}", name='_id', id='_id')
                                      |                       
                                      .form-group.row
                                        .offset-sm-2.col-sm-10
                                          button.btn.btn-primary(type='button' onclick="updateGubaye()") መዝግብ
                      #modal_curr-sm.modal.fade(style='display: none;', aria-hidden='true')
                        .modal-dialog.modal_pic-sm
                          .modal-content
                            .modal-header
                              h5.modal-title ጉባኤ #{user.gubaye.name} : ስርዓተ ትምህርት መመደቢያ
                              button.close(type='button', data-dismiss='modal', aria-label='Close')
                                span(aria-hidden='true') ×
                            .modal-body
                              .form-group(data-select2-id='39')
                                label ወደ ጉባኤው ለማስገባት የሚፈልጉትን ስርዓተ ትምህርት ይምረጡና ሲጨርሱ ጨምር የሚለውን በተን ይጫኑ 
                                select.select2.select2-hidden-accessible(data-placeholder='ስርዓተ ትምህርት ይምረጡ', style='width: 100%;', data-select2-id='7', tabindex='-1', aria-hidden='true')
                                  each curriculum in curriculums
                                    option(data-select2-id='#{curriculum._id}' value='#{curriculum._id}') #{curriculum.name}
                    
                                                         
                            .modal-footer.justify-content-between
                              button.btn.btn-default(type='button', data-dismiss='modal') ዝጋ
                              button.btn.btn-primary(type='button' onclick="addmembers('#{user.gubaye._id}');") ጨምር 
                      #modal_pic-sm.modal.fade(style='display: none;', aria-hidden='true')
                        .modal-dialog.modal_pic-sm
                          .modal-content
                            .modal-header
                              h5.modal-title ጉባኤ #{user.gubaye.name} : የጉባኤ ምስል መቀየሪያ
                              button.close(type='button', data-dismiss='modal', aria-label='Close')
                                span(aria-hidden='true') ×
                            .modal-body
                              .text-center
                                img.profile-user-img.img-fluid.img-circle#gubayeImg(style="width:300px;" src='#{user.gubaye.profilePic}', alt='User profile picture')                                
                            .modal-footer.justify-content-between
                              button.btn.btn-default(type='button', data-dismiss='modal') ዝጋ
     
        section.content
          .container-fluid
      footer.main-footer 
        include ../../../SharedComponents/Layouts/footer.jade
  script(src='../../ADMINLITE/plugins/bootstrap/js/bootstrap.bundle.min.js')
  script(src='../../ADMINLITE/plugins/datatables/jquery.dataTables.js')
  script(src='../../ADMINLITE/plugins/datatables-bs4/js/dataTables.bootstrap4.js')
  script(src='../../ADMINLITE/plugins/bootstrap/js/bootstrap.bundle.min.js')
  link(rel='stylesheet', href='../../ADMINLITE/plugins/datatables-bs4/css/dataTables.bootstrap4.css')
  script.
    function handleFiles() {
      const fileList = this.files; /* now you can work with the file list */
      alert("This");
    }  
    const inputElement = document.getElementById("gubayePic");
    inputElement.addEventListener("input", handleFiles);
    document.getElementById('3').className = "nav-link active"
    document.getElementById('#{user.GubayeID}').className = "nav-link active"

    
    $(function () {
      $("#example1").DataTable();
      $('#example2').DataTable({
        "paging": true,
        "lengthChange": false,
        "searching": false,
        "ordering": true,
        "info": true,
        "autoWidth": false,
      });
    }); 
    // jQuery
    script(src='../../ADMINLITE/plugins/jquery/jquery.min.js')
    // Bootstrap 4
    script(src='../../ADMINLITE/plugins/bootstrap/js/bootstrap.bundle.min.js')